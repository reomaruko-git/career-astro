---
// src/components/templates/TemplateSingle.astro
import BaseLayout from '../../layouts/BaseLayout.astro';
const { entry, Content } = Astro.props;
const data = entry.data;

// ▼ 1. 画像の安全な取得
const mvImage = data.images?.mv || 'https://placehold.jp/1200x630.png?text=No+Image';

// ▼ 2. 配色設定の安全な取得
const colors = data.colors || {
  primary: '#00A968',
  secondary: '#F4F7F6',
  accent: '#F39C12',
  txtMain: '#333333',
};

// ▼ 3. リンクの取得
const affiliateLink = data.affiliateLink || "https://px.a8.net/svt/ejp?a8mat=XXXXXX";
---

<BaseLayout title={data.title} description={data.description}>
<div class="template-wrapper min-h-screen bg-secondary text-txt-main pb-24 md:pb-0">
  
  {/* ▼ ヘッダー */}
  <header class="absolute top-0 left-0 w-full z-50 py-4 px-6">
    <div class="max-w-5xl mx-auto flex justify-between items-center">
      <div class="bg-white/95 backdrop-blur-sm px-5 py-2.5 rounded-full shadow-sm font-bold text-primary tracking-tighter text-sm md:text-base border border-white/20">
        IT・Web業界転職の最適解
      </div>
      <a href={affiliateLink} class="hidden md:block bg-accent hover:bg-opacity-90 text-white text-sm font-bold px-6 py-3 rounded-full shadow-sm transition transform hover:-translate-y-0.5 tracking-wide">
        求人を見る
      </a>
    </div>
  </header>

  {/* ▼▼▼ MVセクション ▼▼▼ */}
  <section class="relative min-h-[640px] flex items-center justify-center overflow-hidden py-20">
    <div class="absolute inset-0 z-0">
      <img src={mvImage} alt="Main Visual" class="w-full h-full object-cover" />
      <div class="absolute inset-0 bg-[radial-gradient(#ffffff_1.5px,transparent_1.5px)] [background-size:24px_24px] opacity-20"></div>
      <div class="absolute inset-0 bg-gradient-to-t from-gray-900/95 via-gray-900/60 to-gray-900/30"></div>
    </div>

    <div class="relative z-10 container max-w-4xl mx-auto px-6 text-center mt-8">
      <p class="text-accent font-bold tracking-[0.2em] uppercase mb-5 text-xs md:text-sm bg-black/30 inline-block px-4 py-1 rounded-full border border-white/10 backdrop-blur-md">
        For Professional Engineers
      </p>
      <h1 class="text-3xl md:text-5xl lg:text-6xl font-extrabold leading-tight mb-6 text-white drop-shadow-md tracking-tighter">
        {data.title}
      </h1>
      <p class="text-gray-100 text-sm md:text-lg font-medium leading-relaxed max-w-2xl mx-auto tracking-normal opacity-90 mb-10">
        {data.description}
      </p>

      {/* MV内ボタン */}
      <div class="relative inline-block group">
        <a href={affiliateLink} class="relative flex flex-col md:flex-row items-center justify-center bg-accent text-white text-xl md:text-2xl font-bold py-5 px-10 md:px-16 rounded-full shadow-md hover:bg-orange-500 transition-all transform hover:-translate-y-0.5 min-w-[300px] md:min-w-[400px]">
          <span>公式サイトで求人を見る</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mt-1 md:mt-0 md:ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
        </a>
        <p class="text-xs text-gray-300 mt-3 font-medium tracking-wider">
          ※登録は無料・1分で完了します
        </p>
      </div>
    </div>
  </section>

  {/* ▼ メインコンテンツ */}
  <main class="relative z-20 px-4 -mt-16 pb-12">
    <div class="max-w-3xl mx-auto">
      
      <article class="bg-white rounded-[2rem] shadow-xl overflow-hidden ring-1 ring-black/5">
        <div class="p-8 md:p-14">
           {/* 本文 */}
           <div class="prose prose-lg max-w-none text-gray-700 leading-loose prose-p:tracking-wide">
              <Content />
           </div>

        </div>
      </article>

      {/* 記事下CTA */}
      <div class="mt-20 text-center mb-10">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 tracking-tight">
          <span class="bg-gradient-to-r from-primary/20 to-transparent px-2 rounded">非公開求人</span>を含む、<br class="md:hidden"/>あなただけの提案を。
        </h2>
        <div class="relative inline-block group">
           <a href={affiliateLink} class="relative flex items-center justify-center bg-white text-txt-main text-xl font-bold py-6 px-14 rounded-full shadow-lg border border-gray-100 hover:bg-gray-50 transition-all min-w-[320px] tracking-tight transform group-hover:scale-[1.01]">
              <span class="text-primary mr-2">公式サイト</span>で求人を見る
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-3 text-gray-400 group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>
           </a>
        </div>
        <p class="text-xs text-gray-500 mt-5 tracking-wide font-medium">※登録は無料・1分で完了します</p>
      </div>

    </div>
  </main>

  <footer class="bg-secondary pt-12 pb-24 md:pb-12 text-center text-xs text-gray-400 font-medium tracking-wider">
    <p>&copy; Career Selection. All Rights Reserved.</p>
  </footer>

  {/* ▼▼▼ スマホ用・追従固定ボタン ▼▼▼ */}
  <div class="fixed bottom-0 left-0 w-full bg-white/95 backdrop-blur-md border-t border-gray-200 px-3 pt-3 md:hidden z-50" style="padding-bottom: max(12px, env(safe-area-inset-bottom))">
    <div class="max-w-sm mx-auto relative">
      <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 w-max">
         <div class="bg-gray-800 text-yellow-300 text-[10px] font-bold px-3 py-1.5 rounded-full shadow-sm relative">
            <span class="relative z-10">年収700万以上の案件も！</span>
            <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 bg-gray-800"></div>
         </div>
      </div>
      <a href={affiliateLink} class="block w-full bg-accent hover:bg-orange-500 text-white text-center font-bold py-3.5 rounded-xl shadow-md flex flex-col justify-center items-center leading-tight transition-all active:scale-95">
        <span class="text-[10px] block mb-0.5 text-white/90 font-bold tracking-wider">完全無料・1分で登録完了</span>
        <span class="text-lg flex items-center justify-center gap-2">
          公式サイトで求人を見る
          <i class="fas fa-chevron-right text-sm"></i>
        </span>
      </a>
    </div>
  </div>

</div>


<style is:global define:vars={{
  'color-primary': colors.primary,
  'color-secondary': colors.secondary,
  'color-accent': colors.accent,
  'color-txt-main': colors.txtMain,
}}>
  /* フォント定義 */
  @font-face {
    font-family: 'LINE Seed JP';
    src: url('https://cdn.jsdelivr.net/gh/kemat/line-seed-jp-webfont@main/fonts/LINESeedJP_OTF-Regular.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: 'LINE Seed JP';
    src: url('https://cdn.jsdelivr.net/gh/kemat/line-seed-jp-webfont@main/fonts/LINESeedJP_OTF-Bold.woff2') format('woff2');
    font-weight: 700;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: 'LINE Seed JP';
    src: url('https://cdn.jsdelivr.net/gh/kemat/line-seed-jp-webfont@main/fonts/LINESeedJP_OTF-ExtraBold.woff2') format('woff2');
    font-weight: 800;
    font-style: normal;
    font-display: swap;
  }

  /* 強制適用 */
  body {
    font-family: "LINE Seed JP", "Helvetica Neue", Arial, sans-serif !important;
  }
  .template-wrapper {
    font-family: "LINE Seed JP", sans-serif !important;
  }

  /* デザイン調整 */
  .prose h2 {
    font-size: 1.75rem;
    font-weight: 800;
    color: var(--color-txt-main);
    border-left: 8px solid var(--color-primary);
    padding-left: 1.25rem;
    margin-top: 4rem;
    margin-bottom: 2rem;
    line-height: 1.3;
    letter-spacing: -0.02em;
  }
  .prose h3 {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--color-txt-main);
    margin-top: 3rem;
    margin-bottom: 1.25rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid #e2e8f0;
    letter-spacing: -0.01em;
  }
  .prose p { margin-bottom: 2rem; text-align: justify; }
  .prose strong {
    color: var(--color-txt-main) !important;
    font-weight: 700 !important; 
    background: linear-gradient(transparent 65%, rgba(0, 169, 104, 0.4) 65%) !important;
    padding: 0 4px;
    -webkit-box-decoration-break: clone;
    box-decoration-break: clone;
  }
  .prose ul { margin-top: 1.5rem; margin-bottom: 2rem; }
  .prose li { margin-top: 0.75rem; margin-bottom: 0.75rem; padding-left: 0.5rem; }
</style>
</BaseLayout>